#!/bin/bash

BACKLIGHT_AC=2
BACKLIGHT_BATTERY=1
BACKLIGHT_MAX=10

backlight_get_step()
{
    echo -n $(( $(cat /sys/class/backlight/intel_backlight/max_brightness) / ${BACKLIGHT_MAX} ))
}

backlight_get()
{
    echo -n $(( $( cat /sys/class/backlight/intel_backlight/brightness ) / $( backlight_get_step )  ))
}

backlight_change()
{
    # Set calculated backlight value.
    value=$(( ${1} * $(backlight_get_step) ))
    echo -n ${value} >| /sys/class/backlight/intel_backlight/brightness
}

main()
{
    # Get current brightness.
    current=$( backlight_get )

    case $1 in
        # Set brightness to min. BACKLIGHT_AC.
        ac)
            if test ${current} -lt ${BACKLIGHT_AC}; then
                backlight_change ${BACKLIGHT_AC}
            fi
            ;;
        # Set brightness to BACKLIGHT_BATTERY.
        battery)
            if test ${current} -gt ${BACKLIGHT_BATTERY}; then
                backlight_change ${BACKLIGHT_BATTERY}
            fi
            ;;
    esac
}

main "$@"
